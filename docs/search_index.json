[["index.html", "HAD5314H - Applied Bayesian Methods in Clinical Epidemiology and Health Care Research University of Toronto Statement of Acknowledgment of Traditional Land", " HAD5314H - Applied Bayesian Methods in Clinical Epidemiology and Health Care Research Kuan Liu Institute of Health Policy, Management and Evaluation University of Toronto 2022-01-03 University of Toronto Statement of Acknowledgment of Traditional Land We wish to acknowledge this land on which the University of Toronto operates. For thousands of years it has been the traditional land of the Huron-Wendat, the Seneca, and the Mississaugas of the Credit. Today, this meeting place is still the home to many Indigenous people from across Turtle Island and we are grateful to have the opportunity to work on this land. Health Sciences Building "],["course-syllabus.html", "Course Syllabus Course Info Course Description Course Textbook and Structure Calendar and Outline Accessibility and Accommodations Academic Integrity Key Resources and Supports for DSLPH Graduate Students License", " Course Syllabus Course Info Course title: Applied Bayesian Methods in Clinical Epidemiology and Health Care Research Semester: Winter 2022 Class hour and location: Friday, 12pm to 3pm (Two parts: Lecture &amp; Tutorial, with 15 mins break in between). Please see Quercus for other course details. Instructors Email Office Hour Kuan Liu (Kuan) mailto:kuan.liu@mail.utoronto.ca Thursday, 12pm to 1pm Juan Pablo Díaz Martínez (Juan Pablo) mailto:juan.diaz.martinez@mail.utoronto.ca Course Description This course will introduce students to Bayesian data analysis. After a thorough review of fundamental concepts in statistics and probability, an introduction will be given to the fundamentals of the Bayesian approach. Students will learn how to use the brms package in the R statistical software environment to carry out Bayesian analyses of data commonly seen in health sciences. Bayesian methods will be covered for binary, continuous and count outcomes in one and two samples, for logistic, linear and Poisson regression, and for meta-analysis. By the end of this course, students will: Understand what is meant by a Bayesian Analysis and how it differs from a typical analysis under the frequentist framework Understand how modern Bayesian models are fitted Understand the role of prior(s) in Bayesian analysis and how to use prior(s) Be able to fit Bayesian models to common types of study outcomes know what aspects of the Bayesian analysis are an essential part of a statistical report Have developed expertise in using the brms program within the R environment Pre-requisites HAD5316H  Biostatistics II: Advanced Techniques in Applied Regression Methods (or CHL5202H Biostatistics II) and basic programming knowledge in R or SAS. HAD5316H or CHL5202H may be taken concurrently with this course. Evaluation Class participation worth 10% and three individual assignments each worth 30% Course Textbook and Structure 2nd edition of the book by Richard McElreath: https://xcelab.net/rm/statistical-rethinking/ (McElreath 2018) Bayesian Approaches to Clincial Trials and Health-Care Evaluation by David Spiegelhalter, free access via UT library (Spiegelhalter, Abrams, and Myles 2003) The lecture slides will be one main resource for this course. McElreath has a series of lectures on YouTube that are well worth watching: https://www.youtube.com/playlist?list=UUNJK6_DZvcMqNSzQdEkzvzA (Links to an external site.). Additionally, this material, https://bookdown.org/content/4857/ (Links to an external site.) provide R code using brms and tidyverse, two R packages to recreate figures and tables in McElreath (2018). Calendar and Outline Date Topics Assignment Jan 7 Course introduction; Why Bayesian; Bayesian versus Frequentist; Bayesian analysis used in clinical research Jan 14 Review of probability and other statistics concepts Jan 21 Introduction to Bayesian approach Assignment 1: hand out Jan 28 Bayesian Inference Feb 4 Priors Assignment 1: due Feb 8 Feb 11 Bayesian estimation Feb 18 Normal Models and Linear Regression Assignment 2: hand out Feb 25 Reading week - no lecture Mar 4 Hierarchical models and convergence Mar 11 Models for Binary Data Assignment 2: due Mar 15 Mar 18 Intro to Bayesian Meta-analysis and Bayesian Network Meta-analysis (Juan Pablo) Assignment 3: hand out Mar 25 Models for Count Data Assignment 3: due Apr 5 Accessibility and Accommodations The University provides academic accommodations for students with disabilities in accordance with the terms of the Ontario Human Rights Code. This occurs through a collaborative process that acknowledges a collective obligation to develop an accessible learning environment that both meets the needs of students and preserves the essential academic requirements of the Universitys courses and programs. For more information, or to register with Accessibility Services, please visit: http://studentlife.utoronto.ca/as. Academic Integrity Academic integrity is essential to the pursuit of learning and scholarship in a university, and to ensuring that a degree from the University of Toronto is a strong signal of each students individual academic achievement. As a result, the University treats cases of cheating and plagiarism very seriously. Help and information is available on the Academic Integrity website. The University of Torontos Code of Behaviour on Academic Matters (http://www.governingcouncil.utoronto.ca/policies/behaveac.htm) outlines the behaviours that constitute academic dishonesty and the processes for addressing academic offences. Key Resources and Supports for DSLPH Graduate Students U of T Student Mental Health Resources U of T Graduate Student Union DLSPH Covid Information DLSPH Student Resources(Policies, Financial Aid, Health and Wellness, etc.) DLSPH Student Handbook License This work is licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. References "],["into.html", "Session 1 Introduction to the course 1.1 About me 1.2 Syllabus 1.3 Some history 1.4 Thinking like a Bayesian using the concept of probability", " Session 1 Introduction to the course Students and instructor introduction Going over course syllabus A brief history of Bayesian inference The Bayesian way of thinking (statistical rethinking?) 1.1 About me I am an Assistant Professor in Health Services Research (outcomes and evaluation method emphasis) at IHPME. I also hold a cross-appointment at the Division of Biostatistics. I received my PhD in Biostatistics from U of T under the supervision of Dr. Eleanor Pullenayegum. My primary research focuses on developing methodology for statistical inference with complex longitudinal data in comparative effectiveness research. My areas of methodological interest include causal inference, Bayesian statistics, longitudinal data analysis, bias analysis, and semi-parametric/parametric joint modelling. If you are interested in working with me for your research/thesis projects, free feel to reach me. Besides academic work and creating fun data visualizations in R (Covid Dashboard; 3D Christmas Tree), I love watercolour painting, taking contemporary dance classes in Toronto, and playing piano as an adult beginner (though I am still waiting for my piano being shipped from Japan). My work for Dr. Burnss systematic review paper on the trustworthiness of published Clinical Practice Guidelines for Pharmacologic Treatments of Hospitalized Patients With COVID-19. Exercise 1.1 (Please introduce yourselves) You can share your program, research interets, learning goals, and hobby. 1.2 Syllabus Detailed course syllabus is posted on Quercus. Some important notes Course schedule LECTURE: 12:05pm - 1:45pm on Fridays TUTORIAL: 2:00pm - 3:00pm on Fridays Ratio may change substantially some weeks 15 mins break between lecture and tutorial Zoom office hour Thursdays between 12:00pm - 1:00pm Begins on January 13, 2021, ends on March 31, 2021 I am happy to arrange for additional virtual office hours Course materials Textbooks are free for access via U of T library account Additional reading materials (e.g., articles) will be posted on Quercus Online course note is open-access (GitHub Repository). Its licensed under a Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License. Please do not use this material for commercial purposes. Course notes for latter sessions might not be available for view. I aim to publish the day before the scheduled lecture. Sample R scripts, data and brms code will be uploaded to Quercus. R and RStudio We will be using R via RStudio for this course. Key packages including tidyverse and brms. You are encouraged to write you assignment using Rmarkdown. Grading Participation under remote learning: accommodation and written explanations Assignments will be handed out on Quercus and submitted to me via email Can I work with peers? Auditing the course Welcome but with caveats (past experience from George) seriously committed (try not to miss classes) expected to have the same level of participation Quercus discussion board (Encourage!) 1.3 Some history 1.3.1 Bayesian history Concepts of Bayesian approach first appeared in the famous paper of Reverent Thomas Bayes (1702-1761), An essay towards solving a problem in the doctrine of chances (Bayes 1763). Thomas Bayes was a Presbyterian Minister who is thought to have been born in 1701 and died 1761. Bayesian approach were never really practiced in Bayes lifetime. His work was developed and popularized by Pierre-Simon Laplace (17491827) in the early 19th century. Though Bayes developed his philosophy during the 1740s, it wasnt until the late twentieth century that this work reached a broad audience. During the more than two centuries in between, the frequentist philosophy dominated statistical research and practice. Frequentist ideas came to predominate in the 20th century as a result of the work of Fisher (1890-1962), Neyman (1894-1981) and Egon Pearson (1984-1980). Reasons why the Bayesian approach did not catch on until relatively recently: debate of Bayesian philosophy and computational power. Bayes rule by Bayes He essentially used probabilistic terms to express arguments about the uncertainty for the parameter of a binomial model Given the number of times in which an unknown event has happened and failed: Required the chance that the probability of its happening in a single trial lies somewhere between any two degrees of probability that can be named. unknown event = e.g., Bernoulli trial probability of its happening in a single trial \\(=p\\) We may know ahead of time, or not (e.g. \\(p=0.5\\) for a fair coin) The Monty Hall Problem and the Bayesian solution by Marilyn vos Savant Suppose youre on a game show, and youre given the choice of three doors: Behind one door is a car; behind the others, goats. You pick a door, say No. 1, and the host, who knows whats behind the doors, opens another door, say No. 3, which has a goat. He then says to you, Do you want to pick door No. 2? Is it to your advantage to switch your choice? From wikipedia, Vos Savants response was that the contestant should switch to the other door. Many readers of vos Savants column refused to believe switching is beneficial and rejected her explanation. After the problem appeared in Parade, approximately 10,000 readers, including nearly 1,000 with PhDs, wrote to the magazine, most of them calling vos Savant wrong (Tierney 1991). We will revisit this problem in session 2 on Probability. I provided a short R simulation below to demonstrate why the contest should switch door - higher chance of winning the game. Monty Hall simulation in R set.seed(890123) monty &lt;- function(switch=F) { doors &lt;- sample(c(&#39;car&#39;, &#39;goat&#39;, &#39;goat&#39;), size=3, replace = FALSE) pick &lt;- sample(1:3, size=1, replace = FALSE) #randomly pick 1 door out of the three doors; # Using logic true or false to determine a win; if (switch==T) { # if you chose to switch, you win if the car is not behind the picked door; win &lt;- ifelse(doors[pick] != &#39;car&#39;, 1, 0) } else { # if you chose not to switch, you win if the car is behind the picked door; win &lt;- ifelse(doors[pick] == &#39;car&#39;, 1, 0) } return(win) #return the winning outcome for each game; } # run the game for 1000 iterations; # and record a vector of winning status for not switch and switch; no_switch_win &lt;- sapply(1:1000, FUN=function(i) monty(switch=F)) switch_win &lt;- sapply(1:1000, FUN=function(i) monty(switch=T)) print(paste(&quot;Chance of winning if we always not switch: &quot;, sum(no_switch_win)/1000)) ## [1] &quot;Chance of winning if we always not switch: 0.37&quot; print(paste(&quot;Chance of winning if we always switch: &quot;, sum(switch_win)/1000)) ## [1] &quot;Chance of winning if we always switch: 0.668&quot; The recent rise in popularity Advances in computing Re-evaluation of subjectivity of Bayesian approach due to its use of priors Key discussion on subjectivity by Gelman (Gelman and Hennig 2017) In discussions of the foundations of statistics, objectivity and subjectivity are seen as opposites. Objectivity is typically seen as a good thing; many see it as a major requirement for good science. Bayesian statistics is often presented as being subjective because of the choice of a prior distribution. It has been argued that the subjectiveobjective distinction is meaningless because all statistical methods, Bayesian or otherwise, require subjective choices, but the choice of prior distribution is sometimes held to be particularly subjective because, unlike the data model, it cannot be determined even in the asymptotic limit. 1.3.2 History of this course Prof. George Tomlinson created this course back in 2004 He taught this course from 2004 to 2017 and again from 2020 to 2021. Prof. Nicholas Mitsakakis taught it in 2019. This is my first time teaching this course. We are making history together =) I have borrowed a lot of course materials from George. Thank you George! Juan Pablo will be our guest lecturer this year! 1.4 Thinking like a Bayesian using the concept of probability 1.4.1 Probability is not unitary Mathematically probability is clearly defined (a quantity between 0 and 1 etc., we will talk about this in session 2) There are a few ways of interpreting probability, most notably, long run relative frequency and subjective probability. 1. Long run relative frequency The classical or frequentist way of interpreting probability is based on the proportion of times an outcome occurs in a large (i.e. approaching infinity) number of repetitions of an experiment. This view has various serious problems, including that it requires the outcome to be observable and the experiment to be indeed repeatable! 2. Subjective probability The alternative way (essentially proposed by Bayes, LaPlace, other later prominent Bayesians) is the subjective probability. It encompasses ones views, opinions or beliefs about an event or statement. This event does not have to be repeatable or the outcome observable. It is based on belief. Using this approach, we can express the uncertainty around parameters using probability distributions (e.g., beta distribution for the risk \\(\\theta\\) of death after an operation) Example from (Johnson, Ott, and Dogucu, n.d.) Exercise 1.2 (Different interpretation of probability/uncertainty) When flipping a fair coin, we say that the probability of flipping Heads is 0.5. How do you interpret this probability? If I flip this coin over and over, roughly 50% will be Heads. Heads and Tails are equally plausible. Both a and b make sense. An election is coming up and a pollster claims that candidate A has a 0.6 probability of winning. How do you interpret this probability? If we observe the election over and over, candidate A will win roughly 60% of the time. Candidate A is much more likely to win than to lose. The pollsters calculation is wrong. Candidate A will either win or lose, thus their probability of winning can only be 0 or 1. In the coin flip example, a Bayesian would conclude that Heads and Tails are equally likely. In contrast, a frequentist would conclude that if we flip the coin over and over and over, roughly 1/2 of these flips will be Heads. 1.4.2 Bayes Rule Bayes rule specifies how a prior probability \\(P(H)\\) of event \\(H\\) is updated in response to the evidence/data \\(E\\) to obtain the posterior probability \\(P(H|E)\\). \\[ P(H|E) = \\frac{P(E|H)P(H)}{P(E)} \\] Event \\(H\\) represents a particular hypothesis1 (or model or parameter) Event \\(E\\) represents observed evidence (or data or information) \\(P(H)\\) is the unconditional or prior probability of \\(H\\) (prior to observing \\(E\\)) \\(P(H|E)\\) is the conditional or posterior probability of \\(H\\) after observing evidence \\(E\\). \\(P(E|H)\\) is the likelihood of evidence \\(E\\) given hypothesis (or model or parameter) \\(H\\) The Bayesian approach provides a probability of the hypothesis given the data/evidence, which is something generally highly desirable from a scientific perspective. 1.4.3 The Scientific Method in steps Define the question or problem Assess the currently available information decide whether it is sufficient or not 2.1 If yes: conclusions, decisions, actions 2.2 If no, proceed to step 3. Determine what additional information is needed and design a study or experiment to obtain it Carry out the study designed in step 3. Use the data obtained in step 4 to update what was previously known. Return to step 2. Bayesian Advantages: Bayesian methods are especially good in step 2 and 5 They can be used for representing well existing knowledge and also to explicitly update uncertainty using new evidence. This is a done in a coherent, natural way. The ELISA test for HIV was widely used in the mid-1990s for screening blood donations. As with most medical diagnostic tests, the ELISA test is not perfect. If a person actually carries the HIV virus, experts estimate that this test gives a positive result 97.7% of the time. (This number is called the sensitivity of the test.) If a person does not carry the HIV virus, ELISA gives a negative (correct) result 92.6% of the time (the specificity of the test). Assume the estimated HIV prevalence at the time was 0.5% of (the prior base rate). Suppose a randomly selected individual tested positive: If we know the likelihood of getting a positive test if HIV is truly present, \\(P(T^+ \\mid D^+) = 0.977\\), and the likelihood of getting a positive test if HIV is not present, \\(P(T^+ \\mid D^-) = 1 - 0.926 = 0.074\\), Using the Bayes Rule, we can calculate the posterior probability of the disease given the result, \\(P(D^+ \\mid T^+)\\) \\[\\begin{aligned} P(D^+ \\mid T^+) &amp; = \\frac{\\text{Chance of HIV positive and test positive} )}{\\text{Chance of test positive}}\\\\ &amp; = \\frac{P(D^+ \\text{and } T^+)}{P(T^+)} \\\\ &amp; = \\frac{P(T^+ \\mid D^+)P(D^+)}{P(T^+)} \\\\ &amp; = \\frac{P(T^+ \\mid D^+)P(D^+)}{P(T^+ \\mid D^+)P(D^+) + P(T^+ \\mid D^-)P(D^-)} \\\\ &amp; = \\frac{0.977*0.005}{0.977*0.005 + 0.074*0.995} = \\frac{0.0049}{0.0785} = 0.0622 \\end{aligned}\\] We will review probability rules in session 2 in details. Demonstrate calculation in R library(tidyverse) hypothesis = c(&quot;Carries HIV&quot;, &quot;Does not carry HIV&quot;) prior = c(0.005, 1 - 0.005) likelihood = c(0.977, 1 - 0.926) # given positive test product = prior * likelihood posterior = product / sum(product) bayes_table = data.frame(hypothesis, prior, likelihood, product, posterior) %&gt;% add_row(hypothesis = &quot;Sum&quot;, prior = sum(prior), likelihood = NA, product = sum(product), posterior = sum(posterior)) knitr::kable(bayes_table, digits = 4, align = &#39;r&#39;) hypothesis prior likelihood product posterior Carries HIV 0.005 0.977 0.0049 0.0622 Does not carry HIV 0.995 0.074 0.0736 0.9378 Sum 1.000 NA 0.0785 1.0000 To summarize conceptually we have some belief about the state of the world, expressed as a mathematical model (such as the linear model used in regression). The Bayesian approach provides an updated belief as a weighted combination of prior beliefs regarding that state and the currently available evidence, with the possibility of the current evidence overwhelming prior beliefs, or prior beliefs remaining largely intact in the face of scant evidence. \\[ \\text{updated belief} = \\text{current evidence} \\times \\text{prior belief or evidence} \\] References "],["lab1-getting-started-with-r-rstudio.html", "Lab1 Getting started with R &amp; Rstudio 1.5 R and Rstudio Installation 1.6 R Packages 1.7 Working in Rstudio 1.8 Basic R (a crash introduction)", " Lab1 Getting started with R &amp; Rstudio Successfully install R and RStudio Install tidyverse and brms Try out some base R code Play with data frame and produce some summary statistics Learn about Rmarkdown with live demo by Juan Pablo 1.5 R and Rstudio Installation R is a language and environment for statistical computing and graphics (https://cran.r-project.org/manuals.html). Many users of R like a tool called RStudio (https://www.rstudio.com/). This software is what is called an Integrated Development Environment (IDE) for R. It has several nice features, including docked windows for your console and syntax-highlighting editor that supports direct code execution, as well as tools for plotting and workspace management. 1.5.1 Windows operating system install R, https://cran.r-project.org/bin/windows/base/ install Rstudio, https://www.rstudio.com/products/rstudio/download/#download YouTube Instruction 1.5.2 macOS operating system install R, https://cran.r-project.org/bin/macosx/ install Rstudio, https://www.rstudio.com/products/rstudio/download/#download (select macOS 10.14+ option) YouTube Instruction 1.6 R Packages Packages are the fundamental units of reproducible R code. They include reusable R functions, the documentation that describes how to use them, and sample data.(Wickham 2015) To load the functions in a given package, we first have to install the package. We do this using the install.packages() function. Run the line of code that installs the tidyverse package below by removing the # at the start of the second line to uncomment the code. R will install the package to a default directory on your computer. If any dialogue box prompts you to set up a personal library instead, click yes. Once we have the package installed, we must load the functions from this library so we can use them within R. # install.packages(tidyverse, dependencies = T) #uncomment this line if you haven&#39;t installed this package; library(tidyverse) # load package library The tidyverse is an opinionated collection of R packages designed for data science. All packages share an underlying design philosophy, grammar, and data structures (https://www.tidyverse.org/). The core packages are ggplot2 (data visualization), dplyr(dataframe manipulation), tidyr(data reshaping), readr(reading datasets), purrr (function and iterations) and tibble(dataframe). 1.6.1 Bayesian Analysis in R using brms package The course will mainly use the brms package in R(Bürkner 2017), which offers a standard R-modelling type interface to the underlying computing engine Stan. Direct use of Stan is not ideal for teaching Bayesian methods. The brms package automatically writes Stan code that can be viewed and edited, so after learning brms, the enterprising student may want to use this Stan code as a steppingstone toward programming directly in Stan. The brms package can be installed and loaded in the same way as any other R package, in this case by typing the following commands in R: #uncomment this line if you haven&#39;t installed this package; # install.packages(brms) library(brms) 1.7 Working in Rstudio 1.7.1 Rstudio layout When you open RStudio, your interface is made up of four panes as shown below. These can be organised via menu options View &gt; Panes &gt; Rstudio layout We can run code in the console at the prompt where R will evaluate it and print the results. However, the best practice is to write your code in a new script file so it can be saved, edited, and reproduced. To open a new script, we select File &gt; New File &gt; R Script. To run code that was written in the script file, you can highlight the code lines you wish be evaluated and press CTRL-Enter (windows) or Cmd+Return (Mac). Additionally, You can comment or uncomment script lines by pressing Ctrl+Shift+C (windows) or Cmd+Shift+C (Mac). The comment operator in R is #. You can find more RStuio default keyboard shortcuts here. In our first tutorial, we will also introduce Rmarkdown, a R version of the markdown file editor that can write and output document in html, word, or pdf format that contents not only the programming code but also any evaluation outputs and graphs. To read more about Rmarkdown, please visit https://rmarkdown.rstudio.com/lesson-1.html. 1.7.2 Customization You can customize your Rstudio session under the Options dialog Tools &gt; Global Options menu (or RStudio &gt; Preferences on a Mac). A list of customization categories can be found here, https://support.rstudio.com/hc/en-us/articles/200549016-Customizing-RStudio. For example, its popular to change Rstudio appearance and themes (e.g., mordern, sky, dark, and classic). 1.7.3 Working directory The working directory is the default location where R will look for files you want to load and where it will put any files you save. You can use function getwd() to display your current working directory and use function setwd() to set your workding directory to a new folder on your computer. One of the great things about using RStudio Projects is that when you open a project it will automatically set your working directory to the appropriate location. getwd() #show my current working directory; ## [1] &quot;D:/GitHub/bayes_bookdown&quot; 1.7.4 Getting help with R The help section of R is extremely useful if you need more information about the packages and functions that you are currently loaded. You can initiate R help using the help function help() or ?, the help operator. help(brms) 1.8 Basic R (a crash introduction) A more comprehensive introduction to base R can be found at https://cran.r-project.org/doc/manuals/r-release/R-intro.html. In this subsection, I will briefly outline some common R functions and commands for arithmetic, creating and working with object, vector, matrix, and data. This short introduction is created using the intro to R workshop notes by Prof. Kevin Thorpe as well as multiple open-source materials. Some important notes R is case sensitive. Commands are separated by a newline in the console. The # character can be used to make comments. R doesnt execute the rest of the line after the # symbol - it ignores it. Previous session commands can be accessed via the up and down arrow keys on the keyboard. When naming in R, avoid using spaces and special characters (i.e., !@#$%^&amp;*()_+=;:\"&lt;&gt;?/) and avoid leading names with numbers. 1.8.1 Arithmetic 2*3 2^3 2 + (2 + 3) * 2 - 5 log(3) exp(3) log(exp(1)) #playing with Euler&#39;s number; sqrt(x) #Logical operators; 5&gt;6 5&lt;=6 5==6 #equal; 6==6 5!=6 #not equal; Exercise 1.3 (Rounding Issues in R) Try evaluating log(0.01^200) and 200*log(0.01) in R. Note that they are mathematically equivalent. log(0.01^200) ## [1] -Inf 200*log(0.01) ## [1] -921.034 1.8.2 Vectors Operator &lt;- is called the assignment operation, we can create a vector (numeric, characteristic, or mixture) using the assignment operation and the c() function. # a vector of a single element; x &lt;- 3 x # a character vector x &lt;- c(&quot;red&quot;, &quot;green&quot;, &quot;yellow&quot;) x length(x) nchar(x) #number of characters for each element; # encode a vector as a factor (or category); y &lt;- factor(c(&quot;red&quot;, &quot;green&quot;, &quot;yellow&quot;, &quot;red&quot;, &quot;red&quot;, &quot;green&quot;)) y class(y) as.numeric(y) # we can return factors with numeric labels; # we can also label numeric vector with factor levels; z &lt;- factor(c(1,2,3,1,1,2), levels = c(1,2,3), labels = c(&quot;red&quot;, &quot;green&quot;,&quot;yellow&quot;)) z class(z) mode(z) #we can use this to create dummy variables for regression; contrasts(z) # a numeric vector; x &lt;- c(10.4, 5.6, 3.1, 6.4, 21.7, 53.5, 3.6, 2.6, 6.1, 1.7) x x[2] x[1:3] x[-1] x[-(1:3)] length(x) #return number of elements; # a numeric vector composed of all integers between 1 and 10; y &lt;- 1:10 y # a numeric vector composed of all even number integers between 0 and 10; z &lt;- seq(0,10, by=2) z # simple vector based calculations; x + y x*y x/y # matrix in R; matrix(1:16, nrow=4) matrix(1:16, nrow=4, byrow=TRUE) matrix(1:16, nrow=4) diag(matrix(1:16, nrow=4)) diag(c(1,-3,7)) diag(3) # matrix calculation; X &lt;- matrix(1:16, nrow=4, byrow=T) X t(X) #transpose; Y &lt;- matrix(seq(1,32, by=2), nrow=4, byrow=T) Y Y + X Y - X 3 * X X * Y X %*% Y #inner product; 1.8.3 Data frame - The Titanic dataset Titanic &lt;- read.csv(&#39;data/Titanic.csv&#39;, header = TRUE, na.strings = &quot;NA&quot;) knitr::kable(rbind(head(Titanic), tail(Titanic)), row.names = FALSE) Id Name PClass Age Sex Survived SexCode 1 Allen, Miss Elisabeth Walton 1st 29.00 female 1 1 2 Allison, Miss Helen Loraine 1st 2.00 female 0 1 3 Allison, Mr Hudson Joshua Creighton 1st 30.00 male 0 0 4 Allison, Mrs Hudson JC (Bessie Waldo Daniels) 1st 25.00 female 0 1 5 Allison, Master Hudson Trevor 1st 0.92 male 1 0 6 Anderson, Mr Harry 1st 47.00 male 1 0 1308 Zabour, Miss Tamini 3rd NA female 0 1 1309 Zakarian, Mr Artun 3rd 27.00 male 0 0 1310 Zakarian, Mr Maprieder 3rd 26.00 male 0 0 1311 Zenni, Mr Philip 3rd 22.00 male 0 0 1312 Lievens, Mr Rene 3rd 24.00 male 0 0 1313 Zimmerman, Leo 3rd 29.00 male 0 0 dim(Titanic) str(Titanic) names(Titanic) Titanic$Age Titanic[,c(&quot;Age&quot;)] Titanic[2:3, 2:3] # some quick dplyr data manipulation; Titanic %&gt;% filter(PClass == &quot;1st&quot;) %&gt;% # filter on 1st class; passengers; select(Id, Name, Age, Sex, Survived) # select these; columns only; # looking at the distinct values; Titanic %&gt;% distinct(PClass) table(Titanic$PClass, useNA = &quot;always&quot;) # counting missing values; Titanic %&gt;% summarise(count = sum(is.na(PClass))) # quick summary; mean(Titanic$Age) sum(is.na(Titanic$Age)) # counting missing values; mean(Titanic$Age, na.rm = TRUE) median(Titanic$Age, na.rm = TRUE) quantile(Titanic$Age, probs =c(0.25,0.75), na.rm = TRUE) Titanic %&gt;% summarise(mean = mean(Age, na.rm = TRUE), na = sum(is.na(Age)), med = median(Age, na.rm = TRUE)) # summary by group; Titanic %&gt;% group_by(PClass) %&gt;% summarise(mean = mean(Age, na.rm = TRUE), na = sum(is.na(Age)), med = median(Age, na.rm = TRUE)) 1.8.4 Simple plots boxplot(Age~PClass, data=Titanic) p &lt;- ggplot(Titanic, aes(x=as.factor(PClass), y=Age)) + geom_boxplot() p ggplot(Titanic, aes(x=as.factor(PClass), y=Age, fill = as.factor(PClass))) + geom_boxplot() + geom_jitter(shape=16, position=position_jitter(0.2)) + labs(title=&quot;Plot of age by passenger class&quot;,x=&quot;Passenger Class&quot;, y = &quot;Age&quot;, fill = &quot;Passenger Class&quot;)+ theme_classic() R Session information ## R version 4.0.5 (2021-03-31) ## Platform: x86_64-w64-mingw32/x64 (64-bit) ## Running under: Windows 10 x64 (build 19042) ## ## Matrix products: ## ## locale: ## [1] LC_COLLATE=English_Canada.1252 LC_CTYPE=English_Canada.1252 ## [3] LC_MONETARY=English_Canada.1252 LC_NUMERIC=C ## [5] LC_TIME=English_Canada.1252 ## ## attached base packages: ## [1] stats graphics grDevices utils datasets methods base ## ## other attached packages: ## [1] brms_2.15.0 Rcpp_1.0.7 forcats_0.5.1 stringr_1.4.0 ## [5] dplyr_1.0.7 purrr_0.3.4 readr_2.0.0 tidyr_1.1.3 ## [9] tibble_3.1.3 ggplot2_3.3.5 tidyverse_1.3.1 References "],["prob.html", "Session 2 Probability, random variables and distributions 2.1 Introduction to Set Theory 2.2 Probability Rules 2.3 Discrete Random Variables 2.4 Common Discrete Distributions 2.5 Continuous Random Variables 2.6 R Quick Reference", " Session 2 Probability, random variables and distributions 2.1 Introduction to Set Theory Before we jump into probability, it is useful to review a little bit of set theory. Events are properties of a particular outcome. For a coin flip, the event Heads would be the event that a heads was flipped. For the single roll of a six-sided die, a possible event might be that the result is even. For the NAU student, we might be interested in the event that the student is a biology student. A second event of interest might be if the student is an undergraduate. 1.1.1 Venn Diagrams Let \\(S\\) be the set of all outcomes of my random trial. Suppose I am interested in two events \\(A\\) and \\(B\\). The traditional way of representing these events is using a Venn diagram. For example, suppose that my random experiment is rolling a fair 6-sided die once. The possible outcomes are \\(S=\\{1,2,3,4,5,6\\}\\). Suppose I then define events \\(A=\\) roll is odd and \\(B=\\) roll is 5 or greater. In this case our picture is: All of our possible events are present, and distributed among our possible events. 2.1.1 Composition of events I am often interested in discussing the composition of two events and we give the common set operations below. Union: Denote the event that either \\(A\\) or \\(B\\) occurs as \\(A\\cup B\\). Intersection: Denote the event that both \\(A\\) and \\(B\\) occur as \\(A\\cap B\\) Complement: Denote the event that \\(A\\) does not occur as \\(\\bar{A}\\) or \\(A^{C}\\) (different people use different notations) Definition: Two events \\(A\\) and \\(B\\) are said to be mutually exclusive (or disjoint) if the occurrence of one event precludes the occurrence of the other. For example, on a single roll of a die, a two and a five cannot both come up. For a second example, define \\(A\\) to be the event that the die is even, and \\(B\\) to be the event that the die comes up as a \\(5\\). 2.2 Probability Rules 2.2.1 Simple Rules We now take our Venn diagrams and use them to understand the rules of probability. The underlying idea that we will use is the the probability of an event is the area in the Venn diagram. Definition: The probability is the proportion of times an event occurs in many repeated trials of a random phenomenon. In other words, it is the long-term relative frequency. Rule: For any event \\(A\\) the probability of the event \\(P(A)\\) satisfies \\(0\\leq P(A) \\leq 1\\). That is to say, the probability of any event will always lie in the interval \\([0,1]\\). Because \\(S\\) is the set of all events that might occur, the area of our bounding rectangle will be \\(1\\) and the probability of event \\(A\\) occurring will be represented by the area in the circle \\(A\\). Rule: The probability of the set of all events (\\(S\\)) is always 1. That is, \\(P(S) = 1\\). General Addition Rule: \\(P(A\\cup B)=P(A)+P(B)-P(A\\cap B)\\) The reason behind this fact is that if there is if \\(A\\) and \\(B\\) are not disjoint, then some area is added twice when I calculate \\(P\\left(A\\right)+P\\left(B\\right)\\). To account for this, I simply subtract off the area that was double counted. Rule: If two events are mutually exclusive, then \\(P(A\\cup B)=P(A)+P(B)\\) Example. Let \\(R\\) be the sum of two different colored dice. Suppose we are interested in \\(P(R \\le 4)\\). Notice that the pair of dice can fall 36 different ways (6 ways for the first die and six for the second results in 6x6 possible outcomes, and each way has equal probability \\(1/36\\). Because the dice cannot simultaneously sum to \\(2\\) and to \\(3\\), we could write \\[\\begin{aligned} P(R \\le 4 ) &amp;= P(R=2)+P(R=3)+P(R=4) \\\\ &amp;= P(\\left\\{ 1,1\\right\\} )+P(\\left\\{ 1,2\\right\\} \\mathrm{\\textrm{ or }}\\left\\{ 2,1\\right\\} )+P(\\{1,3\\}\\textrm{ or }\\{2,2\\}\\textrm{ or }\\{3,1\\}) \\\\ &amp;= \\frac{1}{36}+\\frac{2}{36}+\\frac{3}{36} \\\\ &amp;= \\frac{6}{36} \\\\ &amp;= \\frac{1}{6} \\end{aligned}\\] Complement Rule: \\(P(A)+P(A^c)=1\\) This rule follows from the partitioning of the set of all events (\\(S\\)) into two disjoint sets, \\(A\\) and \\(A^c\\). We learned above that \\(A \\cup A^c = S\\) and that \\(P(S) = 1\\). Combining those statements, we obtain the complement rule. Completeness Rule: \\(P(A)=P(A\\cap B)+P(A\\cap B^c)\\) This identity is just breaking the event \\(A\\) into two disjoint pieces. 2.2.2 Conditional Probability We are given the following data about insurance claims. Notice that the data is given as \\(P(\\;Category\\;\\cap\\;PolicyType\\;)\\) which is apparent because the sum of all the elements in the table is \\(100\\%\\) \\(\\,\\) Fire Auto Other Fraudulant 6% 1% 3% non-Fraudulant 14% 29% 47% Summing across the rows and columns, we can find the probabilities of for each category and policy type. \\(\\,\\) Fire Auto Other \\(\\,\\) Fraudulant 6% 1% 3% 10% non-Fraudulant 14% 29% 47% 90% \\(\\,\\) 20% 30% 50% 100% It is clear that fire claims are more likely fraudulent than auto or other claims. In fact, the proportion of fraudulent claims, given that the claim is against a fire policy is \\[\\begin{aligned} P(\\textrm{ Fraud }|\\textrm{ FirePolicy }) &amp;= \\frac{\\textrm{proportion of claims that are fire policies and are fraudulent}}{\\textrm{proportion of fire claims}} \\\\ &amp;= \\frac{6\\%}{20\\%}\\\\ &amp; \\\\ &amp;= 0.3 \\end{aligned}\\] In general we define conditional probability (assuming \\(P(B) \\ne 0\\)) as \\[P(A|B)=\\frac{P(A\\cap B)}{P(B)}\\] which can also be rearranged to show \\[\\begin{aligned} P(A\\cap B) &amp;= P(A\\,|\\,B)\\,P(B) \\\\ &amp;= P(B\\,|\\,A)\\,P(A) \\end{aligned}\\] Because the order doesnt matter and \\(P\\left(A\\cap B\\right)=P\\left(B\\cap A\\right)\\). Using this rule, we might calculate the probability that a claim is an Auto policy given that it is not fraudulent. \\[\\begin{aligned} P\\left(\\,Auto\\;|\\;NotFraud\\,\\right) &amp;= \\frac{P\\left(\\,Auto\\;\\cap\\;NotFraud\\right)}{P\\left(\\,NotFraud\\,\\right)} \\\\ &amp;= \\frac{0.29}{0.9} \\\\ &amp; \\\\ &amp;= 0.3\\bar{2} \\end{aligned}\\] Definition: Two events \\(A\\) and \\(B\\) are said to be independent if \\(P(A\\cap B)=P(A)P(B)\\). What independence is saying that knowing the outcome of event \\(A\\) doesnt give you any information about the outcome of event \\(B\\). Thus, we can use conditional statements to also show that two events are independent if \\(P(A|B) = P(A)\\). In simple random sampling, we assume that any two samples are independent. In cluster sampling, we assume that samples within a cluster are not independent, but clusters are independent of each other. Fact: If \\(A\\) and \\(B\\) are independent events, then \\(P(A|B) = P(A)\\) and \\(P(B|A) = P(B)\\). These statements follow directly from the given definitions. Example: Suppose that we are interested in the relationship between the color and the type of car. Specifically I will divide the car world into convertibles and non-convertibles and the colors into red and non-red. Suppose that convertibles make up just 10% of the domestic automobile market. This is to say \\(P(\\;Convertable\\;)=0.10\\). Of the non-convertibles, red is not unheard of but it isnt common either. So suppose \\(P(\\;Red\\;|\\;NonConvertable\\;)=0.15\\). However red is an extremely popular color for convertibles so let \\(P(\\;Red\\;|\\;Convertable\\;)=0.60\\). Given the above information, we can create the following table: \\(\\,\\) Convertible Not Convertible \\(\\,\\) Red Not Red \\(\\,\\) 10% 90% 100% We can fill in some of the table using our the definition of conditional probability. For example: \\[\\begin{aligned} P\\left(Red\\,\\cap\\,Convertable\\right) &amp;= P\\left(Red\\,|\\,Convertable\\right)\\,P\\left(Convertable\\right) \\\\ &amp;= 0.60*0.10 \\\\ &amp;= 0.06 \\end{aligned}\\] Lets think about what this conditional probability means. Of the \\(90\\%\\) of cars that are not convertibles, \\(15\\%\\) those non-convertibles are red and therefore the proportion of cars that are red non-convertibles is \\(0.90*0.15=0.135\\). Of the \\(10\\%\\) of cars that are convertibles, \\(60\\%\\) of those are red and therefore proportion of cars that are red convertibles is \\(0.10*0.60=0.06\\). Thus the total percentage of red cars is actually \\[\\begin{aligned}P\\left(\\,Red\\,\\right) &amp;= P\\left(\\;Red\\;\\cap\\;Convertible\\;\\right)+P\\left(\\,Red\\,\\cap\\,NonConvertible\\,\\right)\\\\ &amp;= P\\left(\\,Red\\,|\\,Convertable\\,\\right)P\\left(\\,Convertible\\,\\right)+P\\left(\\,Red\\,|\\,NonConvertible\\,\\right)P\\left(\\,NonConvertible\\,\\right)\\\\ &amp;= 0.60*0.10+0.15*0.90\\\\ &amp;= 0.06+0.135\\\\ &amp;= 0.195 \\end{aligned}\\] So when I ask for \\(P(\\;red\\;|\\;convertable\\;)\\), I am narrowing my space of cars to consider only convertibles. While there percentage of cars that are red and convertible is just 6% of all cars, when I restrict myself to convertibles, we see that the percentage of this smaller set of cars that are red is 60%. Notice that because \\(P\\left(Red\\right)=0.195\\ne0.60=P\\left(Red\\,|\\,Convertable\\right)\\) then the events \\(Red\\) and \\(Convertable\\) are not independent. 2.2.3 Summary of Probability Rules Here we give a short summary of the most frequently used rules. \\[0 \\le P\\left(A\\right) \\le 1\\] \\[P\\left(A\\right)+P\\left(A^c\\right)=1\\] \\[P\\left(A\\cup B\\right) = P\\left(A\\right)+P\\left(B\\right)-P\\left(A\\cap B\\right)\\] \\[P\\left(A\\cap B\\right) = \\begin{cases} P\\left(A\\,|\\,B\\right)P\\left(B\\right)\\\\ P\\left(B\\,|\\,A\\right)P\\left(A\\right)\\\\ P(A)P(B)\\;\\; &amp; \\textrm{ if A,B are independent} \\end{cases}\\] \\[P\\left(A\\,|\\,B\\right) = \\frac{P\\left(A\\cap B\\right)}{P\\left(B\\right)}\\] 2.3 Discrete Random Variables The different types of probability distributions (and therefore your analysis method) can be divided into two general classes: Continuous Random Variables - the variable takes on numerical values and could, in principle, take any of an uncountable number of values. In practical terms, if fractions or decimal points in the number make sense, it is usually continuous. Discrete Random Variables - the variable takes on one of small set of values (or only a countable number of outcomes). In practical terms, if fractions or decimals points dont make sense, it is usually discrete. Previously we distinguished between categorical (e.g. Ford, Chevy, Tesla) and numerical discrete (e.g. number of offspring) but because we could arbitrarily map the categorical labels to the integers, probability theory generally glosses over that distinction and only worries about if their is ordering to the categorical levels. Examples: Presence or Absence of wolves in a State? Number of Speeding Tickets received? Tree girth (in cm)? Photosynthesis rate? 2.3.1 Introduction to Discrete Random Variables The following facts hold for discrete random variables: The probability associated with every value lies between 0 and 1 The sum of all probabilities for all values is equal to 1 Probabilities for discrete RVs are additive. i.e., \\(P(3\\textrm{ or }4)=P(3)+P(4)\\) 2.3.1.1 Expected Value Example: Consider the discrete random variable \\(S\\), the sum of two fair dice. We often want to ask What is expected value of this distribution? You might think about taking a really, really large number of samples from this distribution and then taking the mean of that really really big sample. We define the expected value (often denoted by \\(\\mu\\)) as a weighted average of the possible values and the weights are the proportions with which those values occur. \\[\\mu=E[S] = \\sum_{\\textrm{possible }s}\\;s\\cdot P\\left(S=s\\right)\\] In this case, we have that \\[\\begin{aligned} \\mu = E[S] &amp;= \\sum_{s=2}^{12}s\\cdot P(S=s) \\\\ &amp;= 2\\cdot P\\left(S=2\\right)+3\\cdot P\\left(S=3\\right)+\\dots+11\\cdot P\\left(S=11\\right)+12\\cdot P\\left(S=12\\right) \\\\ &amp;= 2\\left(\\frac{1}{36}\\right)+3\\left(\\frac{2}{36}\\right)+\\dots+11\\left(\\frac{2}{36}\\right)+12\\left(\\frac{1}{36}\\right) \\\\ &amp;= 7 \\end{aligned}\\] 2.3.1.2 Variance Similarly we could define the variance of \\(S\\) (which we often denote \\(\\sigma^{2}\\)) as a weighted average of the squared-deviations that could occur. \\[ \\sigma^{2}=V[S] = \\sum_{\\textrm{possible }s}\\; (s-\\mu)^2 \\cdot P\\left(S=s\\right)\\] which in this example can be calculated as \\[\\begin{aligned} \\sigma^{2}=V[S] &amp;= \\sum_{s=2}^{12}\\left(s-\\mu\\right)^{2}P(S=s) \\\\ &amp;= (2-7)^{2}\\left(\\frac{1}{36}\\right)+(3-7)^{2}\\left(\\frac{2}{36}\\right)+\\dots+(12-7)^{2}\\left(\\frac{1}{36}\\right) \\\\ &amp;= \\frac{35}{6}=5.8\\bar{3} \\end{aligned}\\] We could interpret the expectation as the sample mean of an infinitely large sample, and the variance as the sample variance of the same infinitely large sample. These are two very important numbers that describe the distribution. Example: Aubrey is a massage therapist and over the last year, the number of clients she sees per work day (denoted Y) varied according the following table: Number of Clients 0 1 2 3 4 Frequency/Probability 0.30 0.35 0.20 0.10 0.05 distr &lt;- data.frame( clients = c( 0, 1, 2, 3, 4 ), # two columns probability = c(0.3, 0.35, 0.20, 0.10, 0.05 ) ) # ggplot(distr, aes(x=clients)) + # graph with clients as the x-axis geom_point(aes(y=probability)) + # where the dots go geom_linerange(aes(ymax=probability, ymin=0)) + # the vertical lines theme_bw() # set background color... Because this is the long term relative frequency of the number of clients (over 200 working days!), it is appropriate to interpret these frequencies as probabilities. This table and graph is often called a probability mass function (pmf) because it lists how the probability is spread across the possible values of the random variable. We might next ask ourselves what is the average number of clients per day? \\[\\begin{aligned} E\\left(Y\\right) &amp;= \\sum_{\\textrm{possible }y}y\\,P\\left(Y=y\\right) \\\\ &amp;= \\sum_{y=0}^{4}y\\,P\\left(Y=y\\right) \\\\ &amp;= 0\\,P\\left(Y=0\\right)+1\\,P\\left(Y=1\\right)+2\\,P\\left(Y=2\\right)+3\\,P\\left(Y=3\\right)+4\\,P\\left(Y=4\\right) \\\\ &amp;= 0\\left(0.3\\right)+1\\left(0.35\\right)+2\\left(0.20\\right)+3\\left(0.10\\right)+4\\left(0.05\\right) \\\\ &amp;= 1.25 \\end{aligned}\\] Notice that this number is not an integer and therefore is not a value that \\(Y\\) could actually take on. You might be tempted to therefore round it to the nearest integer. That would be wrong. The rational is that if we wanted to estimate the number of clients she has per month (and thus her income), we would have a worse estimate if we used the rounded number. Another example of a case where rounding would be inappropriate is in gambling situations where the amount won or lost per hand isnt particularly important but the average amount won or lost over hundreds or thousands of plays is what matters. A Roulette wheel has 18 red and 18 black slots along with 2 green. If you bet $1 on red, you could either win a dollar or lose a dollar. However, because the probabilities are Win ( + $1 ) Lose (- $1) Probability \\(\\frac{18}{38}\\) \\(\\frac{20}{38}\\) then the persons expected winnings per play are: \\[ \\begin{aligned}E[W] = \\sum_{\\textrm{possible }w}w\\,P\\left(W=w\\right) = 1 \\left(\\frac{18}{38} \\right) + -1 \\left( \\frac{20}{38} \\right) = -0.0526 \\end{aligned}\\] So for every Black/Red bet, the player should expect to lose 5.2 cents. While this number is small, it is enough to make the casino millions of dollars over the long run. Returning to the massage therapy example, assuming that successive days are independent (which might be a bad assumption) what is the probability she has two days in a row with no clients? \\[\\begin{aligned}P\\left(\\textrm{0 on day1 }and\\textrm{ 0 on day2}\\right) &amp;= P\\left(\\textrm{0 on day 1}\\right)P\\left(\\textrm{0 on day 2}\\right) \\\\ &amp;= \\left(0.3\\right)\\left(0.3\\right) \\\\ &amp;= 0.09 \\end{aligned}\\] What is the variance of this distribution? \\[\\begin{aligned}V\\left(Y\\right) &amp;= \\sum_{\\textrm{possible y}}\\,\\left(y-\\mu\\right)^{2}\\,P\\left(Y=y\\right) \\\\ &amp;= \\sum_{y=0}^{4}\\,\\left(y-\\mu\\right)^{2}P\\left(Y=y\\right) \\\\ &amp;= \\left(0-1.25\\right)^{2}\\left(0.3\\right)+\\left(1-1.25\\right)^{2}\\left(0.35\\right)+\\left(2-1.25\\right)^{2}\\left(0.20\\right)+\\left(3-1.25\\right)^{2}\\left(0.10\\right)+\\left(4-1.25\\right)^{2}\\left(0.05\\right) \\\\ &amp;= 1.2875 \\end{aligned}\\] Note on Notation: There is a difference between the upper and lower case letters we have been using to denote a random variable. In general, we let the upper case denote the random variable and the lower case as a value that the the variable could possibly take on. So in the massage example, the number of clients seen per day \\(Y\\) could take on values \\(y=0,1,2,3,\\) or \\(4\\). 2.4 Common Discrete Distributions 2.4.1 Binomial Distribution Example: Suppose we are trapping small mammals in the desert and we spread out three traps. Assume that the traps are far enough apart that having one being filled doesnt affect the probability of the others being filled and that all three traps have the same probability of being filled in an evening. Denote the event that a trap is filled with a critter as \\(C_{i}\\) and denote the event that the trap is empty as \\(E_{i}\\). Denote the probability that a trap is filled by \\(\\pi=0.8\\). (This sort of random variable is often referred to as a Bernoulli RV.) The possible outcomes are Outcome \\(\\,\\) \\(E_1, E_2, E_3\\) \\(\\,\\) \\(C_1, E_2, E_3\\) \\(\\,\\) \\(E_1, C_2, E_3\\) \\(\\,\\) \\(E_1, E_2, C_3\\) \\(\\,\\) \\(C_1, C_2, E_3\\) \\(\\,\\) \\(C_1, E_2, C_3\\) \\(\\,\\) \\(E_1, C_2, C_3\\) \\(\\,\\) \\(C_1, C_2, C_3\\) \\(\\,\\) Because these are far apart enough in space that the outcome of Trap1 is independent of Trap2 and Trap3, then \\[P(E_{1}\\cap C_{2}\\cap E_{3}) = P(E_{1})P(C_{2})P(E_{3}) = (1-0.8)0.8(1-0.8) = 0.032\\] Notice how important the assumption of independence is!!! Similarly we could calculate the probabilities for the rest of the table. Outcome Probability \\(S\\) Outcome Probability \\(E_1, E_2, E_3\\) 0.008 \\(S=0\\) 0.008 -  -  \\(C_1, E_2, E_3\\) 0.032 \\(E_1, C_2, E_3\\) 0.032 \\(S=1\\) \\(3(0.032) = 0.096\\) \\(E_1, E_2, C_3\\) 0.032 -  -  \\(C_1, C_2, E_3\\) 0.128 \\(C_1, E_2, C_3\\) 0.128 \\(S=2\\) \\(3(0.128) = 0.384\\) \\(E_1, C_2, C_3\\) 0.128 -  -  \\(C_1, C_2, C_3\\) 0.512 \\(S=3\\) \\(0.512\\) Next we are interested in the random variable \\(S\\), the number of traps that were filled: \\(S\\) Outcome Probability \\(S=0\\) \\(0.008\\) \\(S=1\\) \\(0.096\\) \\(S=2\\) \\(0.384\\) \\(S=3\\) \\(0.512\\) \\(S\\) is an example of a Binomial Random Variable. A binomial experiment is one that: Experiment consists of \\(n\\) identical trials. Each trial results in one of two outcomes (Heads/Tails, presence/absence). One will be labeled a success and the other a failure. The probability of success on a single trial is equal to \\(\\pi\\) and remains the same from trial to trial. The trials are independent (this is implied from property 3). The random variable \\(Y\\) is the number of successes observed during \\(n\\) trials. Recall that the probability mass function (pmf) describes how the probability is spread across the possible outcomes, and in this case, I can describe this via a nice formula. The pmf of a a binomial random variable \\(X\\) taken from \\(n\\) trials each with probability of success \\(\\pi\\) is \\[P(X=x)=\\underbrace{\\frac{n!}{x!(n-x)!}}_{orderings}\\;\\underbrace{\\pi^{x}}_{y\\,successes}\\;\\underbrace{(1-\\pi)^{n-x}}_{n-y\\,failures}\\] where we define \\(n!=n(n-1)\\dots(2)(1)\\) and further define \\(0!=1\\). Often the ordering term is written more compactly as \\[{n \\choose x}=\\frac{n!}{x!\\left(n-x\\right)!}\\]. For our small mammal example we can create a graph that shows the binomial distribution with the following R code: dist &lt;- data.frame( x=0:3 ) %&gt;% mutate(probability = dbinom(x, size=3, prob=0.8)) ggplot(dist, aes(x=x)) + geom_point(aes(y=probability)) + geom_linerange(aes(ymax=probability, ymin=0)) + ggtitle(&#39;Binomial distribution: n=3, p=0.8&#39;) + theme_bw() To calculate the height of any of these bars, we can evaluate the pmf at the desired point. For example, to calculate the probability the number of full traps is 2, we calculate the following \\[\\begin{aligned} P(X=2) &amp;= {3 \\choose 2}\\left(0.8\\right)^{2}\\left(1-0.8\\right)^{3-2} \\\\ &amp;= \\frac{3!}{2!(3-2)!}(0.8)^{2}(0.2)^{3-2} \\\\ &amp;= \\frac{3\\cdot2\\cdot1}{(2\\cdot1)1}\\;(0.8)^{2}(0.2) \\\\ &amp;= 3(0.128) \\\\ &amp;= 0.384 \\end{aligned}\\] You can use R to calculate these probabilities. In general, for any distribution, the d-function gives the distribution function (pmf or pdf). So to get R to do the preceding calculation we use: # If X ~ Binomial(n=3, pi=0.8) # Then P( X = 2 | n=3, pi=0.8 ) = dbinom(2, size=3, prob=0.8) ## [1] 0.384 The expectation of this distribution can be shown to be \\[\\begin{aligned}E[X] &amp;= \\sum_{x=0}^{n}x\\,P(X=x) \\\\ &amp;= \\sum_{x=0}^{n}x\\;\\frac{n!}{x!\\left(n-x\\right)!}\\pi^{x}\\left(1-\\pi\\right)^{n-x}\\\\ &amp;= \\vdots \\\\ &amp;= n\\pi \\end{aligned}\\] and the variance can be similarly calculated \\[\\begin{aligned} V[X] &amp;= \\sum_{x=0}^{n}\\left(x-E\\left[X\\right]\\right)^{2}\\,P\\left(X=x|n,\\pi\\right) \\\\ &amp;= \\sum_{x=0}^{n}\\left(x-E\\left[X\\right]\\right)^{2}\\;\\frac{n!}{x!\\left(n-x\\right)!}\\pi^{x}\\left(1-\\pi\\right)^{n-x} \\\\ &amp;= \\vdots \\\\ &amp;= n\\pi(1-\\pi) \\end{aligned}\\] Example: Suppose a bird survey only captures the presence or absence of a particular bird (say the mountain chickadee). Assuming the true presence proportion at national forest sites around Flagstaff is \\(\\pi=0.1\\), then for \\(n=20\\) randomly chosen sites, the number of sites in which the bird was observed would have the following PMF. dist &lt;- data.frame( x = 0:20 ) %&gt;% mutate(probability = dbinom(x, size=20, prob=0.1)) ggplot(dist, aes(x=x)) + geom_point(aes(y=probability)) + geom_linerange(aes(ymax=probability, ymin=0)) + ggtitle(&#39;Binomial distribution: n=20, p=0.1&#39;) + xlab(&#39;Number of Sites Occupied&#39;) + theme_bw() Often we are interested in questions such as \\(P(X\\le2)\\) which is the probability that we see 2 or fewer of the sites being occupied by mountain chickadee. These calculations can be tedious to calculate by hand but R will calculate these cumulative distribution function values for you using the p-function. This cumulative distribution function gives the sum of all values up to and including the number given. # P(X=0) + P(X=1) + P(X=2) sum &lt;- dbinom(0, size=20, prob=0.1) + dbinom(1, size=20, prob=0.1) + dbinom(2, size=20, prob=0.1) sum ## [1] 0.6769268 # P(X &lt;= 2) pbinom(2, size=20, prob=0.1) ## [1] 0.6769268 In general we will be interested in asking four different questions about a distribution. What is the height of the probability mass function (or probability density function). For discrete variable \\(Y\\) this is \\(P\\left(Y=y\\right)\\) for whatever value of \\(y\\) we want. In R, this will be the d-function. What is the probability of observing a value less than or equal to \\(y\\)? In other words, to calculate \\(P\\left(Y\\le y\\right)\\). In R, this will be the p-function. What is a particular quantile of a distribution? For example, what value separates the lower \\(25\\%\\) from the upper \\(75\\%\\)? In R, this will be the q-function. Generate a random sample of values from a specified distribution. In R, this will be the r-function. 2.4.2 Poisson Distribution A commonly used distribution for count data is the Poisson. Number of customers arriving over a 5 minute interval Number of birds observed during a 10 minute listening period Number of prairie dog towns per 1000 hectares Number of alga clumps per cubic meter of lake water A discrete RV is a Poisson RV if the following conditions apply: Two or more events do not occur at precisely the same time or in the same space The occurrence of an event in a given period of time or region of space is independent of the occurrence of the event in a non overlapping period or region. The expected number of events during one period or region, \\(\\lambda\\), is the same in all periods or regions of the same size. Assuming that these conditions hold for some count variable \\(Y\\), the the probability mass function is given by \\[P(Y=y)=\\frac{\\lambda^{y}e^{-\\lambda}}{y!}\\] where \\(\\lambda\\) is the expected number of events over 1 unit of time or space and \\(e\\) is the constant \\(2.718281828\\dots\\). \\[E[Y] = \\lambda\\] \\[Var[Y] = \\lambda\\] Example: Suppose we are interested in the population size of small mammals in a region. Let \\(Y\\) be the number of small mammals caught in a large trap over a 12 hour period. Finally, suppose that \\(Y\\sim Poisson(\\lambda=2.3)\\). What is the probability of finding exactly 4 critters in our trap? \\[P(Y=4) = \\frac{2.3^{4}\\,e^{-2.3}}{4!} = 0.1169\\] What about the probability of finding at most 4? \\[\\begin{aligned} P(Y\\le4) &amp;= P(Y=0)+P(Y=1)+P(Y=2)+P(Y=3)+P(Y=4) \\\\ &amp;= 0.1003+0.2306+0.2652+0.2033+0.1169 \\\\ &amp;= 0.9163 \\end{aligned}\\] What about the probability of finding 5 or more? \\[P(Y\\ge5) = 1-P(Y\\le4) = 1-0.9163 = 0.0837\\] These calculations can be done using the distribution function (d-function) for the Poisson and the cumulative distribution function (p-function). dist &lt;- data.frame( NumCaught = 0:10 ) %&gt;% mutate( probability = dpois( NumCaught, lambda=2.3 ) ) ggplot(dist, aes(x=NumCaught)) + geom_point( aes(y=probability) ) + geom_linerange(aes( ymax=probability, ymin=0)) + ggtitle(expression(paste(&#39;Poisson Distribution with &#39;, lambda == 2.3))) + labs(x=&#39;Number Caught&#39;) + theme_bw() # P( Y = 4) dpois(4, lambda=2.3) ## [1] 0.1169022 # P( Y &lt;= 4) ppois(4, lambda=2.3) ## [1] 0.9162493 # 1-P(Y &lt;= 4) == P( Y &gt; 4) == P( Y &gt;= 5) 1-ppois(4, 2.3) ## [1] 0.08375072 2.5 Continuous Random Variables Continuous random variables can take on an (uncountably) infinite number of values, and this results in a few obnoxious mathematical differences between how we handle continuous and discrete random variables. In particular, the probability that a continuous random variable \\(X\\) will take on a particular value will be zero, so we will be interested in finding the probability that the random variable is in some interval instead. Wherever we had a summation, \\(\\sum\\), we will instead have an integral, but because many students havent had calculus, we will resort to using R or tables of calculated values. 2.5.1 Uniform(0,1) Distribution Suppose you wish to draw a random number number between 0 and 1 and any two intervals of equal size should have the same probability of the value being in them. This random variable is said to have a Uniform(0,1) distribution. Because there are an infinite number of rational numbers between 0 and 1, the probability of any particular number being selected is \\(1/\\infty=0\\). But even though each number has 0 probability of being selected, some number must end up being selected. Because of this conundrum, probability theory doesnt look at the probability of a single number, but rather focuses on a region of numbers. To make this distinction, we will define the distribution using a probability density function (pdf) instead of the probability mass function. In the discrete case, we had to constrain the probability mass function to sum to 1. In the continuous case, we have to constrain the probability density function to integrate to 1. Finding the area under the curve of a particular density function \\(f(x)\\) usually requires the use of calculus, but since this isnt a calculus course, we will resort to using R or tables of calculated values. 2.5.2 Exponential Distribution The exponential distribution is the continuous analog of the Poisson distribution and is often used to model the time between occurrence of successive events. Perhaps we are modeling time between transmissions on a network, or the time between feeding events or prey capture. If the random variable \\(X\\) has an Exponential distribution, its probability density function is \\[f(x)=\\begin{cases} \\lambda e^{-\\lambda x} &amp; x\\ge0\\;\\textrm{ and }\\;\\lambda&gt;0\\\\ 0 &amp; \\textrm{otherwise} \\end{cases}\\] Analogous to the discrete distributions, we can define the Expectation and Variance of these distributions by replacing the summation with an integral \\[\\mu = E[X] = \\int_{0}^{\\infty}x\\,f(x)\\,dx = \\dots = \\frac{1}{\\lambda} \\] \\[\\sigma^2 = Var[X] = \\int_{0}^{\\infty}\\left(x-\\mu\\right)^{2}\\,f\\left(x\\right)\\,dx = \\dots = \\frac{1}{\\lambda^{2}}\\] Because the exponential distribution is defined by the rate of occurrence of an event, increasing that rate decreases the time between events. Furthermore because the rate of occurrence cannot be negative, we restrict \\(\\lambda&gt;0\\). Example: Suppose the time between insect captures \\(X\\) during a summer evening for a species of bat follows a exponential distribution with capture rate of \\(\\lambda=2\\) insects per minute and therefore the expected waiting time between captures is \\(1/\\lambda=1/2\\) minute. Suppose that we are interested in the probability that it takes a bat more than 1 minute to capture its next insect. \\[P(X&gt;1)=\\] data &lt;- data.frame(x=seq(0,5,length=1000), lambda = 2) %&gt;% mutate(y=dexp(x, rate = lambda), grp = ifelse( x &gt; 1, &#39;&gt; 1&#39;, &#39;&lt;= 1&#39;)) ggplot(data, aes(x=x, y=y, fill=grp)) + geom_area() + labs(y=&#39;density&#39;) + theme_bw() We now must resort to calculus to find this area. Or use tables of pre-calculated values. Or use R, remembering that p-functions give the area under the curve to the left of the given value. # P(X &gt; 1) == 1 - P(X &lt;= 1) ### Complement Rule 1 - pexp(1, rate=2) ## [1] 0.1353353 2.5.3 Normal Distribution Undoubtedly the most important distribution in statistics is the normal distribution. If my RV \\(X\\) is normally distributed with mean \\(\\mu\\) and standard deviation \\(\\sigma\\), its probability density function is given by \\[f(x)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left[-\\frac{(x-\\mu)^{2}}{2\\sigma^{2}}\\right]\\] where \\(\\exp[y]\\) is the exponential function \\(e^{y}\\). We could slightly rearrange the function to \\[f(x)=\\frac{1}{\\sqrt{2\\pi}\\sigma}\\exp\\left[-\\frac{1}{2}\\left(\\frac{x-\\mu}{\\sigma}\\right)^{2}\\right]\\] and see this distribution is defined by its expectation \\(E[X]=\\mu\\) and its variance \\(Var[X]=\\sigma^{2}\\). Notice I could define it using the standard deviation \\(\\sigma\\), and different software packages will expect it to be defined by one or the other. R defines the normal distribution using the standard deviation. ## Warning: It is deprecated to specify `guide = FALSE` to remove a guide. Please ## use `guide = &quot;none&quot;` instead. Example: It is known that the heights of adult males in the US is approximately normal with a mean of 5 feet 10 inches (\\(\\mu=70\\) inches) and a standard deviation of \\(\\sigma=3\\) inches. One of the textbook authors is a mere 5 feet 4 inches (64 inches). What proportion of the population is shorter than the author? distr &lt;- data.frame(x=seq(57, 82, length=1000)) %&gt;% mutate( density = dnorm(x, mean=70, sd=3), group = ifelse(x&lt;=64, &#39;Shorter&#39;,&#39;Taller&#39;) ) ggplot(distr, aes(x=x, y=density, fill=group)) + geom_line() + geom_area() + theme_bw() Using R you can easily find this pnorm(64, mean=70, sd=3) ## [1] 0.02275013 2.6 R Quick Reference We give a brief summary of the distributions used most in this course and the abbreviations used in R. Distribution Stem Parameters Parameter Interpretation Binomial binom size prob Number of Trials, Probability of Success (per Trial) Exponential exp rate Mean of the distribution Normal norm mean=0 sd=1 Center of the distribution, Standard deviation Uniform unif min=0 max=1 Minimum and Maximum of the distribution All the probability distributions available in R are accessed in exactly the same way, using a d-function, p-function, q-function, and r-function. Function Result d-function(x) The height of the probability distribution/density at \\(x\\) p-function(x) \\(P\\left(X\\le x\\right)\\) q-function(q) \\(x\\) such that \\(P\\left(X\\le x\\right) = q\\) r-function(n) \\(n\\) random observations from the distribution The mosaic package has versions of the p and q -functions that also print a out nice picture of the probabilities that you ask for. These functions are named by just adding an x at the beginning of the function. For example mosaic::xpnorm(-1). "],["bayes.html", "Session 3 Bayesian inference 3.1 Priors 3.2 Posterior 3.3 Prediction 3.4 Decision theory", " Session 3 Bayesian inference 3.1 Priors 3.2 Posterior 3.3 Prediction 3.4 Decision theory "],["Prior.html", "Session 4 Considering Prior Distributions", " Session 4 Considering Prior Distributions "],["BayesReg.html", "Session 5 Bayesian Regression 5.1 Normal Models and Linear Regression 5.2 Hierarchical models and convergence 5.3 Models for Binary Data 5.4 Models for Count Data", " Session 5 Bayesian Regression 5.1 Normal Models and Linear Regression 5.2 Hierarchical models and convergence 5.3 Models for Binary Data 5.4 Models for Count Data "],["references.html", "References", " References "]]
